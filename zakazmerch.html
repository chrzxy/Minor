<!DOCTYPE html>
<html lang="ru">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Решение алгоритмической задачи</title>


    <!-- Bootstrap CSS -->
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" rel="stylesheet">



    <link rel="stylesheet" href="styleall.css">
</head>

<body>

    <div class="container">

        <header class="text-center mb-4">
            <img src="https://upload.wikimedia.org/wikipedia/commons/6/60/Смешарики_логотип.png" class="img-fluid"
                style="max-width: 200px;" alt="Смешарики логотип">
            <h1 class="hero-title">СМЕШАРИКИ И ВСЁ, ЧТО С НИМИ СВЯЗАНО</h1>
        </header>


        <div class="card" id="top_of_page">
            <div class="card-body text-center">
                <nav class="simple-nav">
                    <a class="simple-nav-link" href="index.html">Главная</a>
                    <a class="simple-nav-link" href="boot.html">Магазин</a>
                    <a class="simple-nav-link active" href="zakazmerch.html">Форма</a>
                </nav>
            </div>
        </div>
        <div class="card card-custom light-block">
            <div class="card-body">
                <h5 class='card-title text-center'>Заказ мерча Смешариков</h5>
                <form action="https://www.bing.com/search" method="get" target="_blank" id="orderForm">


                    <div class="mb-3">
                        <label for="surname" class="form-label">Фамилия *</label>
                        <input type="text" class="form-control" id="surname" name="surname"
                            placeholder="Введите фамилию" value="Иванов" required>
                    </div>

                    <div class="mb-3">
                        <label for="name" class="form-label">Имя *</label>
                        <input type="text" class="form-control" id="name" name="name" placeholder="Введите имя"
                            value="Иван" required>
                    </div>

                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="email" class="form-label">Email *</label>
                            <input type="email" class="form-control" id="email" name="email"
                                value="customer@example.com" required>
                        </div>
                        <div class="col-md-6">
                            <label for="phone" class="form-label">Телефон *</label>
                            <input type="text" class="form-control" id="phone" name="phone" value="+79001234567"
                                required>
                        </div>

                        <div class="col-12">
                            <label for="address" class="form-label">Адрес доставки *</label>
                            <input type="text" class="form-control" id="address" name="address"
                                placeholder="Улица, дом, квартира" value="ул. Пушкина, д. 10, кв. 5" required>
                        </div>

                        <div class="col-md-6">
                            <label for="city" class="form-label">Город *</label>
                            <input type="text" class="form-control" id="city" name="city" value="Москва" required>
                        </div>
                        <div class="col-md-4">
                            <label for="region" class="form-label">Область/Край</label>
                            <select id="region" class="form-select" name="region">
                                <option value="Московская" selected>Московская область</option>
                                <option value="Ленинградская">Ленинградская область</option>
                                <option value="Новосибирская">Новосибирская область</option>
                                <option value="Свердловская">Свердловская область</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label for="zip" class="form-label">Индекс *</label>
                            <input type="text" class="form-control" id="zip" name="zip" value="101000" required>
                        </div>
                    </div>


                    <div class="row mt-4">
                        <div class="col-md-6">
                            <h6>Выберите персонажа:</h6>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="character" id="character_krosh"
                                    value="Крош" checked>
                                <label class="form-check-label" for="character_krosh">
                                    Крош
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="character" id="character_ezhik"
                                    value="Ёжик">
                                <label class="form-check-label" for="character_ezhik">
                                    Ёжик
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="character" id="character_barash"
                                    value="Бараш">
                                <label class="form-check-label" for="character_barash">
                                    Бараш
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="character" id="character_nyusha"
                                    value="Нюша">
                                <label class="form-check-label" for="character_nyusha">
                                    Нюша
                                </label>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <h6>Выберите товар:</h6>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="product" id="product_tshirt"
                                    value="Футболка" checked>
                                <label class="form-check-label" for="product_tshirt">
                                    Футболка
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="product" id="product_mug"
                                    value="Кружка">
                                <label class="form-check-label" for="product_mug">
                                    Кружка
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="product" id="product_cap"
                                    value="Кепка">
                                <label class="form-check-label" for="product_cap">
                                    Кепка
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-md-4">
                            <label for="size" class="form-label">Размер *</label>
                            <select id="size" class="form-select" name="size">
                                <option value="S" selected>S</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                                <option value="XL">XL</option>
                                <option value="XXL">XXL</option>
                            </select>
                        </div>

                        <div class="col-md-4">
                            <label for="quantity" class="form-label">Количество *</label>
                            <input type="number" class="form-control" id="quantity" name="quantity" min="1" max="10"
                                value="2" required>
                        </div>

                        <div class="col-md-4">
                            <label for="color" class="form-label">Цвет товара</label>
                            <input type="text" class="form-control" id="color" name="color" value="Синий">
                        </div>
                    </div>


                    <div class="mb-3 mt-4">
                        <label for="comment" class="form-label">Комментарий к заказу</label>
                        <textarea class="form-control" id="comment" name="comment" rows="3"
                            placeholder="Ваши пожелания">Хочу получить заказ как можно скорее</textarea>
                    </div>


                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="terms" name="terms" value="принято" checked>
                        <label class="form-check-label" for="terms">
                            Я согласен с условиями доставки и возврата *
                        </label>
                    </div>

                    <div class="form-check mb-4">
                        <input class="form-check-input" type="checkbox" id="newsletter" name="newsletter"
                            value="подписка_оформлена" checked>
                        <label class="form-check-label" for="newsletter">
                            Подписаться на новости о новых коллекциях мерча
                        </label>
                    </div>


                    <input type="hidden" name="q" value="search">


                    <div class="col-12">
                        <button type="submit" class="btn btn-primary">Отправить заказ</button>
                        <button type="reset" class="btn btn-secondary">Сбросить форму</button>
                    </div>
                </form>
            </div>
        </div>
        <script>
            function submitToBing(event) {
                event.preventDefault(); 

             
                const formData = {
                    customer_surname: document.getElementById('surname').value,
                    customer_name: document.getElementById('name').value,
                    customer_email: document.getElementById('email').value,
                    customer_phone: document.getElementById('phone').value,
                    delivery_address: document.getElementById('address').value,
                    delivery_city: document.getElementById('city').value,
                    delivery_region: document.getElementById('region').value,
                    delivery_zip: document.getElementById('zip').value,
                    character: document.querySelector('input[name="character"]:checked').value,
                    product_type: document.querySelector('input[name="product"]:checked').value,
                    product_size: document.getElementById('size').value,
                    product_quantity: document.getElementById('quantity').value,
                    product_color: document.getElementById('color').value,
                    order_comment: document.getElementById('comment').value,
                    terms_accepted: document.getElementById('terms').checked ? "yes" : "no",
                    newsletter_subscribed: document.getElementById('newsletter').checked ? "yes" : "no"
                };

                const params = new URLSearchParams(formData).toString();

                
                const bingUrl = `https://www.bing.com/search?q=Заказ+мерча+Смешариков&${params}`;

             
                window.location.href = bingUrl;
                console.log("Отправляем данные в Bing:", formData);
                console.log("URL для перехода:", bingUrl);

                
                try {
                    const orderHistory = JSON.parse(localStorage.getItem('smesharikiOrders') || '{"orders": []}');
                    orderHistory.orders.push(formData);
                    localStorage.setItem('smesharikiOrders', JSON.stringify(orderHistory));
                } catch (e) {
                    console.error("Ошибка сохранения в localStorage:", e);
                }


                window.open(bingUrl, '_blank');

                return false;
            }


            document.getElementById('orderForm').addEventListener('submit', submitToBing);


            function readOrderFromUrl() {
                const url = new URL(window.location.href);
                const orderData = url.hash.match(/order=([^&]+)/);

                if (orderData && orderData[1]) {
                    try {
                        const decodedJson = decodeURIComponent(orderData[1]);
                        return JSON.parse(decodedJson);
                    } catch (e) {
                        console.error("Ошибка чтения данных из URL:", e);
                        return null;
                    }
                }
                return null;
            }

            window.addEventListener('DOMContentLoaded', () => {
                const lastOrder = localStorage.getItem('lastOrder');
                if (lastOrder) {
                    try {
                        const data = JSON.parse(lastOrder);

                        console.log("Загружены предыдущие данные:", data);
                    } catch (e) {
                        console.error("Ошибка загрузки предыдущих данных:", e);
                    }
                }
            });
        </script>